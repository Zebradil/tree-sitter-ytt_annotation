#@ load("@ytt:data", "data")
#@ load("traefik.lib.yaml", "route")

#@ def search_fn(idx, left, right):
#@   if left["kind"] == "IngressRoute":
#@     return True
#@   else:
#@     return False
#@   end
#@ end

#@ for/end route_doc in route.default(data.values.myks.context.app):
--- #@ route_doc

#@overlay/match by=search_fn, expects="1+"
---
spec:
  routes:
    #@overlay/match by=overlay.all
    - services:
        #@overlay/match by=overlay.all
        - #@overlay/replace via=lambda left, right: return left > right
          kind: TraefikService
          name: api@internal
